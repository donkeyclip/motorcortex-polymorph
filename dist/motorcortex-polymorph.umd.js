!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("@donkeyclip/motorcortex")):"function"==typeof define&&define.amd?define(["@donkeyclip/motorcortex"],r):(e="undefined"!=typeof globalThis?globalThis:e||self)["@donkeyclip/motorcortex-polymorph"]=r(e.MotorCortex)}(this,(function(e){"use strict";var r={},t={},n={},i={},o={};Object.defineProperty(o,"__esModule",{value:!0}),o._=void 0,o.SPACE=" ",o.FILL="fill",o.NONE="none",o.DRAW_LINE_VERTICAL="V",o.DRAW_LINE_HORIZONTAL="H",o.DRAW_LINE="L",o.CLOSE_PATH="Z",o.MOVE_CURSOR="M",o.DRAW_CURVE_CUBIC_BEZIER="C",o.DRAW_CURVE_SMOOTH="S",o.DRAW_CURVE_QUADRATIC="Q",o.DRAW_CURVE_QUADRATIC_CONTINUATION="T",o.DRAW_ARC="A";var a={};Object.defineProperty(a,"__esModule",{value:!0}),a.isString=function(e){return"string"==typeof e};var s={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});var r=Math;e.abs=r.abs,e.min=r.min,e.max=r.max,e.floor=r.floor,e.round=r.round,e.sqrt=r.sqrt,e.pow=r.pow,e.cos=r.cos,e.asin=r.asin,e.sin=r.sin,e.tan=r.tan,e.PI=r.PI,e.QUADRATIC_RATIO=2/3,e.EPSILON=e.pow(2,-52)}(s),Object.defineProperty(i,"__esModule",{value:!0});var l=o,u=a,c=s;i.renderPath=function(e,r){if(void 0===r&&(r=c.round),u.isString(e))return e;for(var t=[],n=0;n<e.length;n++){var i=e[n];t.push(l.MOVE_CURSOR,r(i[0]),r(i[1]),l.DRAW_CURVE_CUBIC_BEZIER);for(var o=void 0,a=2;a<i.length;a+=6){var s=r(i[a]),f=r(i[a+1]),_=r(i[a+2]),v=r(i[a+3]),d=r(i[a+4]),p=r(i[a+5]);s==d&&_==d&&f==p&&v==p&&o==(o=""+s+f+_+v+d+p)||t.push(s,f,_,v,d,p)}}return t.join(l.SPACE)};var f={};Object.defineProperty(f,"__esModule",{value:!0});var _=o;f.raiseError=function(){throw new Error(Array.prototype.join.call(arguments,_.SPACE))};var v={},d={},p={},A={};Object.defineProperty(A,"__esModule",{value:!0});var g="undefined"!=typeof window&&window.navigator.userAgent;A.isEdge=/(MSIE |Trident\/|Edge\/)/i.test(g),Object.defineProperty(p,"__esModule",{value:!0});var h=A.isEdge?Array:Float32Array;p.createNumberArray=function(e){return new h(e)};var y={};Object.defineProperty(y,"__esModule",{value:!0});var R=s;y.computeAbsoluteOrigin=function(e,r,t){var n=function(e){for(var r=e[0],t=e[1],n=t,i=r,o=2;o<e.length;o+=6){var a=e[o+4],s=e[o+5];r=R.min(r,a),i=R.max(i,a),t=R.min(t,s),n=R.max(n,s)}return{x:r,w:i-r,y:t,h:n-t}}(t);return{x:n.x+n.w*e,y:n.y+n.h*r}},Object.defineProperty(d,"__esModule",{value:!0});var m=p,P=y;d.fillSegments=function e(r,t,n){var i=r.length,o=t.length;if(i<o)return e(t,r,n);t.length=i;for(var a=o;a<i;a++){var s=r[a],l=n.x,u=n.y;if(!n.absolute){var c=P.computeAbsoluteOrigin(l,u,s);l=c.x,u=c.y}for(var f=m.createNumberArray(s.length),_=0;_<s.length;_+=2)f[_]=l,f[_+1]=u;t[a]=f}};var O={},I={};Object.defineProperty(I,"__esModule",{value:!0});var C=p;I.rotatePoints=function(e,r){var t,n=e.length,i=n-r,o=C.createNumberArray(r);for(t=0;t<r;t++)o[t]=e[t];for(t=r;t<n;t++)e[t-r]=e[t];for(t=0;t<r;t++)e[i+t]=o[t]};var E={};Object.defineProperty(E,"__esModule",{value:!0});var b=s;E.distance=function(e,r,t,n){return b.sqrt((e-t)*(e-t)+(r-n)*(r-n))},Object.defineProperty(O,"__esModule",{value:!0});var D=I,T=o,U=E,x=y;O.normalizePoints=function(e,r,t,n){var i=n.length;if(n[i-2]===n[0]&&n[i-1]===n[1]){if(!e){var o=x.computeAbsoluteOrigin(r,t,n);r=o.x,t=o.y}var a,s,l=n.slice(2);i=l.length;for(var u=0;u<i;u+=6){var c=U.distance(r,r,l[u],l[u+1]);(s===T._||c<s)&&(s=c,a=u)}D.rotatePoints(l,a),n[0]=l[i-2],n[1]=l[i-1];for(u=0;u<l.length;u++)n[u+2]=l[u]}};var M={};Object.defineProperty(M,"__esModule",{value:!0});var S=s,j=p;function L(e,r){var t=r-e.length,n=Math.ceil(r/e.length),i=j.createNumberArray(r);i[0]=e[0],i[1]=e[1];for(var o=1,a=1;a<r-1;){i[++a]=e[++o],i[++a]=e[++o],i[++a]=e[++o],i[++a]=e[++o];var s=i[++a]=e[++o],l=i[++a]=e[++o];if(t)for(var u=0;u<n&&t;u++)i[a+5]=i[a+3]=i[a+1]=s,i[a+6]=i[a+4]=i[a+2]=l,a+=6,t-=6}return i}M.fillPoints=function(e,r){for(var t=e[0].length,n=0;n<t;n++){var i=e[0][n],o=e[1][n],a=S.max(i.length+r,o.length+r);e[0][n]=L(i,a),e[1][n]=L(o,a)}},M.fillSubpath=L;var N={},V={};Object.defineProperty(V,"__esModule",{value:!0});var W=s,Q=E;V.perimeterPoints=function(e){for(var r=e.length,t=e[r-2],n=e[r-1],i=0,o=0;o<r;o+=6)i+=Q.distance(e[o],e[o+1],t,n),t=e[o],n=e[o+1];return W.floor(i)},Object.defineProperty(N,"__esModule",{value:!0});var w=V;N.getSortedSegments=function(e){return e.map((function(e){return{points:e,perimeter:w.perimeterPoints(e)}})).sort((function(e,r){return r.perimeter-e.perimeter})).map((function(e){return e.points}))},Object.defineProperty(v,"__esModule",{value:!0});var z=d,H=O,q=M,B=o,Z=f,F=N;v.normalizePaths=function(e,r,t){t.optimize===B.FILL&&(e=F.getSortedSegments(e),r=F.getSortedSegments(r)),e.length!==r.length&&(t.optimize===B.FILL?z.fillSegments(e,r,t.origin):Z.raiseError("optimize:none requires equal lengths"));var n=Array(2);if(n[0]=e,n[1]=r,t.optimize===B.FILL){for(var i=t.origin,o=i.x,a=i.y,s=i.absolute,l=0;l<e.length;l++)H.normalizePoints(s,o,a,n[0][l]),H.normalizePoints(s,o,a,n[1][l]);q.fillPoints(n,6*t.addPoints)}return n};var k={};Object.defineProperty(k,"__esModule",{value:!0}),k.fillObject=function(e,r){for(var t in r)e.hasOwnProperty(t)||(e[t]=r[t]);return e},Object.defineProperty(n,"__esModule",{value:!0});var $=i,X=s,Y=f,G=v,J=k,K=p,ee=o,re={addPoints:0,optimize:ee.FILL,origin:{x:0,y:0},precision:0};function te(e,r,t){var n=G.normalizePaths(e.getData(),r.getData(),t),i=n[0].length;return function(t){if(X.abs(t-0)<X.EPSILON)return e.getStringData();if(X.abs(t-1)<X.EPSILON)return r.getStringData();for(var o=Array(i),a=0;a<i;a++)o[a]=ne(n[0][a],n[1][a],t);return o}}function ne(e,r,t){for(var n=e.length,i=K.createNumberArray(n),o=0;o<n;o++)i[o]=e[o]+(r[o]-e[o])*t;return i}n.interpolatePath=function(e,r){r=J.fillObject(r,re),(!e||e.length<2)&&Y.raiseError("invalid arguments");for(var t=e.length-1,n=Array(t),i=0;i<t;i++)n[i]=te(e[i],e[i+1],r);var o=r.precision?function(e){return e.toFixed(r.precision)}:ee._;return function(e){var r=t*e,i=X.min(X.floor(r),t-1);return $.renderPath(n[i]((r-i)/(i+1)),o)}},n.mixPoints=ne;var ie={},oe={},ae={},se={};Object.defineProperty(se,"__esModule",{value:!0});var le=o;se.coalesce=function(e,r){return e===le._?r:e};var ue={};Object.defineProperty(ue,"__esModule",{value:!0});var ce=s,fe=120*ce.PI/180,_e=2*ce.PI;ue.arcToCurve=function e(r,t,n,i,o,a,s,l,u,c,f,_,v){if(n<=0||i<=0)return[r,t,l,u,l,u];var d,p=ce.PI/180*(+o||0),A=ce.cos(p),g=ce.sin(p),h=!!c;if(!h){var y=r,R=l,m=((r=y*A-t*-g)-(l=R*A-u*-g))/2,P=((t=y*-g+t*A)-(u=R*-g+u*A))/2,O=m*m/(n*n)+P*P/(i*i);O>1&&(n*=O=ce.sqrt(O),i*=O);var I=(a===s?-1:1)*ce.sqrt(ce.abs((n*n*i*i-n*n*P*P-i*i*m*m)/(n*n*P*P+i*i*m*m)));_=I*n*P/i+(r+l)/2,v=I*-i*m/n+(t+u)/2,c=ce.asin((t-v)/i),f=ce.asin((u-v)/i),r<_&&(c=ce.PI-c),l<_&&(f=ce.PI-f),c<0&&(c+=_e),f<0&&(f+=_e),s&&c>f&&(c-=_e),!s&&f>c&&(f-=_e)}if(ce.abs(f-c)>fe){var C=f,E=l,b=u;f=c+fe*(s&&f>c?1:-1),d=e(l=_+n*ce.cos(f),u=v+i*ce.sin(f),n,i,o,0,s,E,b,f,C,_,v)}else d=[];var D=4/3*ce.tan((f-c)/4);if(d.splice(0,0,2*r-(r+D*n*ce.sin(c)),2*t-(t-D*i*ce.cos(c)),l+D*n*ce.sin(f),u-D*i*ce.cos(f),l,u),!h)for(var T=0,U=d.length;T<U;T+=2){var x=d[T],M=d[T+1];d[T]=x*A-M*g,d[T+1]=x*g+M*A}return d},Object.defineProperty(ae,"__esModule",{value:!0});var ve=o,de=se,pe=f,Ae=s,ge=ue,he={M:2,H:1,V:1,L:2,Z:0,C:6,S:4,Q:4,T:2,A:7};function ye(e,r,t,n,i,o,a){var s=e.x,l=e.y;e.x=de.coalesce(o,s),e.y=de.coalesce(a,l),e.current.push(de.coalesce(r,s),t=de.coalesce(t,l),n=de.coalesce(n,s),i=de.coalesce(i,l),e.x,e.y),e.lc=e.c}function Re(e){var r=e.c,t=e.t,n=e.x,i=e.y;if(r===ve.DRAW_LINE_VERTICAL)t[0]+=i;else if(r===ve.DRAW_LINE_HORIZONTAL)t[0]+=n;else if(r===ve.DRAW_ARC)t[5]+=n,t[6]+=i;else for(var o=0;o<t.length;o+=2)t[o]+=n,t[o+1]+=i}function me(e){return e.split(ve.SPACE).map(Pe)}function Pe(e,r){return 0===r?e:+e}ae.parsePoints=function(e){for(var r={x:0,y:0,segments:[]},t=function(e){return e.replace(/[\^\s]*([mhvlzcsqta]|\-?\d*\.?\d+)[,\$\s]*/gi," $1").replace(/([mhvlzcsqta])/gi," $1").trim().split("  ").map(me)}(e),n=0;n<t.length;n++){var i=t[n],o=i[0],a=o.toUpperCase(),s=a!==ve.CLOSE_PATH&&a!==o;r.c=a;var l=he[a],u=i,c=1;do{r.t=1===u.length?u:u.slice(c,c+l),s&&Re(r);var f=r.t,_=r.x,v=r.y,d=void 0,p=void 0,A=void 0,g=void 0,h=void 0,y=void 0;if(a===ve.MOVE_CURSOR)r.segments.push(r.current=[r.x=f[0],r.y=f[1]]);else if(a===ve.DRAW_LINE_HORIZONTAL)ye(r,ve._,ve._,ve._,ve._,f[0],ve._);else if(a===ve.DRAW_LINE_VERTICAL)ye(r,ve._,ve._,ve._,ve._,ve._,f[0]);else if(a===ve.DRAW_LINE)ye(r,ve._,ve._,ve._,ve._,f[0],f[1]);else if(a===ve.CLOSE_PATH)ye(r,ve._,ve._,ve._,ve._,r.current[0],r.current[1]);else if(a===ve.DRAW_CURVE_CUBIC_BEZIER)ye(r,f[0],f[1],f[2],f[3],f[4],f[5]),r.cx=f[2],r.cy=f[3];else if(a===ve.DRAW_CURVE_SMOOTH){var R=r.lc!==ve.DRAW_CURVE_SMOOTH&&r.lc!==ve.DRAW_CURVE_CUBIC_BEZIER;ye(r,d=R?ve._:2*_-r.cx,p=R?ve._:2*v-r.cy,f[0],f[1],f[2],f[3]),r.cx=f[0],r.cy=f[1]}else if(a===ve.DRAW_CURVE_QUADRATIC){var m=f[0],P=f[1];A=f[2],g=f[3],ye(r,_+(m-_)*Ae.QUADRATIC_RATIO,v+(P-v)*Ae.QUADRATIC_RATIO,A+(m-A)*Ae.QUADRATIC_RATIO,g+(P-g)*Ae.QUADRATIC_RATIO,A,g),r.cx=m,r.cy=P}else if(a===ve.DRAW_CURVE_QUADRATIC_CONTINUATION)A=f[0],g=f[1],r.lc===ve.DRAW_CURVE_QUADRATIC||r.lc===ve.DRAW_CURVE_QUADRATIC_CONTINUATION?(d=_+(2*_-r.cx-_)*Ae.QUADRATIC_RATIO,p=v+(2*v-r.cy-v)*Ae.QUADRATIC_RATIO,h=A+(2*_-r.cx-A)*Ae.QUADRATIC_RATIO,y=g+(2*v-r.cy-g)*Ae.QUADRATIC_RATIO):(d=h=_,p=y=v),ye(r,d,p,h,y,A,g),r.cx=h,r.cy=y;else if(a===ve.DRAW_ARC)for(var O=ge.arcToCurve(_,v,f[0],f[1],f[2],f[3],f[4],f[5],f[6]),I=0;I<O.length;I+=6)ye(r,O[I],O[I+1],O[I+2],O[I+3],O[I+4],O[I+5]);else pe.raiseError(r.c," is not supported");c+=l}while(c<u.length)}return r.segments},Object.defineProperty(oe,"__esModule",{value:!0});var Oe=f,Ie=ae,Ce=o,Ee=/^([#|\.]|path)/i;oe.convertToPathData=function(e){if(Array.isArray(e))return{data:e,stringData:Ce._};var r;if("string"==typeof e&&Ee.test(e)?e=document.querySelector(e):r=e,"string"==typeof e)return{data:Ie.parsePoints(e),stringData:r};var t=e;return"PATH"===t.tagName.toUpperCase()?(r=t.getAttribute("d"),{data:Ie.parsePoints(r),stringData:r}):Oe.raiseError("Unsupported element ",t.tagName)},Object.defineProperty(ie,"__esModule",{value:!0});var be=oe,De=s,Te=o,Ue=function(){function e(e){var r=be.convertToPathData(e),t=r.data,n=r.stringData;this.data=t,this.stringData=n}return e.prototype.getData=function(){return this.data},e.prototype.getStringData=function(){return this.stringData||(this.stringData=this.render())},e.prototype.render=function(e){void 0===e&&(e=De.round);for(var r=this.data,t=[],n=0;n<r.length;n++){var i=r[n];t.push(Te.MOVE_CURSOR,e(i[0]),e(i[1]),Te.DRAW_CURVE_CUBIC_BEZIER);for(var o=void 0,a=2;a<i.length;a+=6){var s=e(i[a]),l=e(i[a+1]),u=e(i[a+2]),c=e(i[a+3]),f=e(i[a+4]),_=e(i[a+5]);s==f&&u==f&&l==_&&c==_&&o==(o=""+s+l+u+c+f+_)||t.push(s,l,u,c,f,_)}}return t.join(Te.SPACE)},e}();ie.Path=Ue,Object.defineProperty(t,"__esModule",{value:!0});var xe=n,Me=ie;t.interpolate=function(e,r){return xe.interpolatePath(e.map((function(e){return new Me.Path(e)})),r||{})},Object.defineProperty(r,"__esModule",{value:!0});var Se=t,je=r.interpolate=Se.interpolate,Le=ie;r.Path=Le.Path;class Ne extends e.Effect{onGetContext(){this.interpolator=je([this.initialValue,this.animAttributes.d],{addPoints:this.attrs.addPoints||0,origin:{x:this.attrs.originX||0,y:this.attrs.originY||0},precision:this.attrs.precision||"fill"})}getScratchValue(){return this.element.getAttribute("d")}onProgress(e){this.element.setAttribute("d",this.interpolator(this.getFraction(e)))}}return{npm_name:"@donkeyclip/motorcortex-polymorph",version:"2.2.0",incidents:[{exportable:Ne,name:"Polymorph",attributesValidationRules:{animatedAttrs:{type:"object",props:{d:{optional:!1,type:"string"}}},addPoints:{optional:!0,type:"number",min:0},originX:{optional:!0,type:"number",min:0,max:1},originY:{optional:!0,type:"number",min:0,max:1},precision:{optional:!0,type:"number",min:0,max:100}}}]}}));
